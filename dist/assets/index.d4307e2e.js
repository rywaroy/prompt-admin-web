import{g as oe,b as se}from"./index.a59a51ca.js";import{c as o,A as K,s as k,d as ee,r as te,F as re,a as i,o as _,b as I,w as p,m as J,u as f,e as C,f as L,g as N,t as ce,h as G,i as H,_ as ue,j as h,k as ie,l as de,n as y,P as Q,E as pe,D as me,p as ve,M as W,q as V,C as fe,v as _e}from"./index.ec028e1a.js";var ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},be=ge;function X(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable}))),r.forEach(function(c){Oe(e,c,n[c])})}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=function(t,n){var r=X({},t,n.attrs);return o(K,X({},r,{icon:be}),null)};q.displayName="MinusOutlined";q.inheritAttrs=!1;var he=q,Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},Se=Pe;function Y(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable}))),r.forEach(function(c){ye(e,c,n[c])})}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(t,n){var r=Y({},t,n.attrs);return o(K,Y({},r,{icon:Se}),null)};R.displayName="SaveOutlined";R.inheritAttrs=!1;var Ce=R;const E=e=>k.get(`/prompt?id=${e}`),ke=e=>k.get(`/prompt/${e}`),$e=e=>k.post("/prompt",e),Z=e=>k.put(`/prompt/${e.id}`,e),je=e=>k.delete(`/prompt/${e}`),Me=ee({name:"UpdatePrompt"}),we=Object.assign(Me,{props:{visible:Boolean,formState:Object},emits:["update:visible","submit"],setup(e,{emit:t}){const n=e,r={span:4},c={span:14},s=te({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],model:[{required:!0,message:"\u8BF7\u9009\u62E9\u6A21\u578B"}]}),O=[{label:"gpt-3.5-turbo",value:"gpt-3.5-turbo"},{label:"gpt-4",value:"gpt-4"}],{resetFields:g,validate:m,validateInfos:$}=re.useForm(n.formState,s),A=()=>{t("update:visible",!1)},j=()=>{m().then(()=>{t("submit",ce(n.formState))})};return(T,b)=>{const z=i("a-input"),M=i("a-form-item"),F=i("a-select-option"),U=i("a-select"),P=i("a-form"),B=i("a-modal");return _(),I(B,{title:e.formState.id?"\u7F16\u8F91":"\u65B0\u589E",visible:e.visible,onCancel:A,onOk:j},{default:p(()=>[o(P,{"label-col":r,"wrapper-col":c},{default:p(()=>[o(M,J({label:"\u540D\u79F0"},f($).name),{default:p(()=>[o(z,{value:e.formState.name,"onUpdate:value":b[0]||(b[0]=v=>e.formState.name=v)},null,8,["value"])]),_:1},16),o(M,J({label:"\u6A21\u578B"},f($).model),{default:p(()=>[o(U,{value:e.formState.model,"onUpdate:value":b[1]||(b[1]=v=>e.formState.model=v)},{default:p(()=>[(_(),C(N,null,L(O,v=>o(F,{key:v.value,value:v.value},{default:p(()=>[G(H(v.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},16)]),_:1})]),_:1},8,["title","visible"])}}});const xe={class:"prompt-container"},Ve={class:"prompt-group"},Ae={class:"prompt-content"},ze={class:"prompt-content-top"},Fe={key:0,class:"prompt-list"},Ue={class:"prompt-result"},Be=ee({name:"Group"}),De=Object.assign(Be,{setup(e){let t;const n=h([]),r=h([]),c=h(null),s=h({}),O=h([]),g=h(!1),m=te({}),$=ie(()=>s.value.fragments?s.value.fragments.filter(a=>a.selected).map(a=>a.content).join(`
`):""),A=a=>{s.value.fragments[a].selected=!s.value.fragments[a].selected},j=a=>{a===void 0?s.value.fragments.push({content:"",selected:!1}):s.value.fragments.splice(a+1,0,{content:"",selected:!1})},T=a=>{s.value.fragments.splice(a,1)},b=a=>{ke(a).then(l=>{s.value=l.data})},z=()=>{W.confirm({title:"\u63D0\u793A",content:"\u786E\u5B9A\u4FDD\u5B58\u5417\uFF1F",onOk(){s.value.fragments.forEach((a,l)=>{a.orderIndex=l}),Z(s.value).then(()=>{V.success("\u4FDD\u5B58\u6210\u529F")})}})},M=a=>{const{id:l,name:d,model:w}=a;l?Z({id:l,name:d,model:w,fragments:s.value.fragments}).then(()=>{V.success("\u66F4\u65B0\u6210\u529F"),g.value=!1,E(t).then(S=>{r.value=S.data})}):$e({name:d,model:w,groupId:t}).then(()=>{V.success("\u521B\u5EFA\u6210\u529F"),g.value=!1,E(t).then(S=>{r.value=S.data})})},F=()=>{m.id=null,m.name="",m.model="gpt-3.5-turbo",g.value=!0},U=()=>{const{id:a,name:l,model:d}=s.value;m.id=a,m.name=l,m.model=d,g.value=!0},P=a=>{t=a[0],E(t).then(l=>{const d=l.data;d.length?(c.value=d[0].id,b(d[0].id)):(c.value=null,s.value={}),r.value=d})},B=()=>{W.confirm({title:"\u63D0\u793A",content:`\u786E\u5B9A\u5220\u9664${s.value.name}\u5417\uFF1F`,onOk(){je(s.value.id).then(()=>{V.success("\u5220\u9664\u6210\u529F"),P([t])})}})},v=()=>{oe().then(a=>{const l=se(a.data);n.value=l,l.length>0&&(O.value=[l[0].id],P(O.value))})};return de(()=>{v()}),(a,l)=>{const d=i("a-tree"),w=i("a-select-option"),S=i("a-select"),ne=i("a-textarea"),ae=i("a-button"),le=i("page-container");return _(),I(le,null,{default:p(()=>[y("div",xe,[y("div",Ve,[o(d,{selectedKeys:O.value,"onUpdate:selectedKeys":l[0]||(l[0]=u=>O.value=u),"tree-data":n.value,"field-names":{children:"children",title:"name",key:"id"},onSelect:P},null,8,["selectedKeys","tree-data"])]),y("div",Ae,[y("div",ze,[o(S,{value:c.value,"onUpdate:value":l[1]||(l[1]=u=>c.value=u),class:"prompt-content-name",onChange:b},{default:p(()=>[(_(!0),C(N,null,L(r.value,u=>(_(),I(w,{key:u.id,value:u.id},{default:p(()=>[G(H(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),o(f(Q),{class:"prompt-icon-add",onClick:F}),o(f(pe),{class:"prompt-icon-edit",onClick:U}),o(f(Ce),{class:"prompt-icon-save",onClick:z}),o(f(me),{class:"prompt-icon-delete",onClick:B})]),s.value.id?(_(),C("div",Fe,[(_(!0),C(N,null,L(s.value.fragments,(u,D)=>(_(),C("div",{key:u.id,class:"prompt-item"},[o(f(fe),{class:_e(["prompt-checked",{active:u.selected}]),onClick:x=>A(D)},null,8,["class","onClick"]),o(ne,{value:u.content,"onUpdate:value":x=>u.content=x,"auto-size":{minRows:1},class:"prompt-text"},null,8,["value","onUpdate:value"]),o(f(Q),{class:"prompt-plus",onClick:x=>j(D)},null,8,["onClick"]),o(f(he),{class:"prompt-minus",onClick:x=>T(D)},null,8,["onClick"])]))),128)),o(ae,{type:"primary",onClick:l[2]||(l[2]=u=>j())},{default:p(()=>[G("\u6DFB\u52A0")]),_:1})])):ve("",!0)]),y("div",Ue,H($.value),1)]),o(we,{visible:g.value,"onUpdate:visible":l[3]||(l[3]=u=>g.value=u),"form-state":m,onSubmit:M},null,8,["visible","form-state"])]),_:1})}}});var Le=ue(De,[["__scopeId","data-v-398d9d08"]]);export{Le as default};
