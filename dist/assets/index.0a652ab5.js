import{g as ie,b as pe}from"./index.b7fe3e33.js";import{c as o,A as ee,s as x,d as te,r as ne,F as de,a as i,o as b,b as N,w as p,m as Q,u as f,e as w,f as R,g as G,t as me,h as $,i as H,_ as ve,j as fe,k as O,l as _e,n as be,p as k,P as W,E as ge,D as Oe,q as he,M as X,v as A,C as ye,x as Se}from"./index.5d395885.js";var Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},Ce=Pe;function Y(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?Object(arguments[a]):{},u=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),u.forEach(function(c){ke(e,c,t[c])})}return e}function ke(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var q=function(a,t){var u=Y({},a,t.attrs);return o(ee,Y({},u,{icon:Ce}),null)};q.displayName="MinusOutlined";q.inheritAttrs=!1;var we=q,$e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},xe=$e;function Z(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?Object(arguments[a]):{},u=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(t).filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),u.forEach(function(c){je(e,c,t[c])})}return e}function je(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var T=function(a,t){var u=Z({},a,t.attrs);return o(ee,Z({},u,{icon:xe}),null)};T.displayName="SaveOutlined";T.inheritAttrs=!1;var Me=T;const L=e=>x.get(`/prompt?id=${e}`),Ve=e=>x.get(`/prompt/${e}`),Ae=e=>x.post("/prompt",e),K=e=>x.put(`/prompt/${e.id}`,e),Ue=e=>x.delete(`/prompt/${e}`),ze=te({name:"UpdatePrompt"}),Fe=Object.assign(ze,{props:{visible:Boolean,formState:Object},emits:["update:visible","submit"],setup(e,{emit:a}){const t=e,u={span:4},c={span:14},h=ne({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],model:[{required:!0,message:"\u8BF7\u9009\u62E9\u6A21\u578B"}]}),s=[{label:"gpt-3.5-turbo",value:"gpt-3.5-turbo"},{label:"gpt-4",value:"gpt-4"}],{resetFields:y,validate:_,validateInfos:v}=de.useForm(t.formState,h),S=()=>{a("update:visible",!1)},j=()=>{_().then(()=>{a("submit",me(t.formState))})};return(J,g)=>{const U=i("a-input"),P=i("a-form-item"),z=i("a-select-option"),F=i("a-select"),B=i("a-form"),I=i("a-modal");return b(),N(I,{title:e.formState.id?"\u7F16\u8F91":"\u65B0\u589E",visible:e.visible,onCancel:S,onOk:j},{default:p(()=>[o(B,{"label-col":u,"wrapper-col":c},{default:p(()=>[o(P,Q({label:"\u540D\u79F0"},f(v).name),{default:p(()=>[o(U,{value:e.formState.name,"onUpdate:value":g[0]||(g[0]=d=>e.formState.name=d)},null,8,["value"])]),_:1},16),o(P,Q({label:"\u6A21\u578B"},f(v).model),{default:p(()=>[o(F,{value:e.formState.model,"onUpdate:value":g[1]||(g[1]=d=>e.formState.model=d)},{default:p(()=>[(b(),w(G,null,R(s,d=>o(z,{key:d.value,value:d.value},{default:p(()=>[$(H(d.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},16)]),_:1})]),_:1},8,["title","visible"])}}});const Be={class:"prompt-container"},Ie={class:"prompt-group"},De={class:"prompt-content"},Ee={class:"prompt-content-top"},Le={key:0,class:"prompt-list"},Ne={class:"prompt-result"},Re=te({name:"Group"}),Ge=Object.assign(Re,{setup(e){const a=fe();let t;const u=O([]),c=O([]),h=O(null),s=O({}),y=O([]),_=O(!1),v=ne({}),S=O(!1),j=_e(()=>s.value.fragments?s.value.fragments.filter(l=>l.selected).map(l=>l.content).join(`
`):""),J=l=>{s.value.fragments[l].selected=!s.value.fragments[l].selected},g=l=>{l===void 0?s.value.fragments.push({content:"",selected:!1}):s.value.fragments.splice(l+1,0,{content:"",selected:!1})},U=l=>{s.value.fragments.splice(l,1)},P=l=>{Ve(l).then(n=>{s.value=n.data})},z=()=>{X.confirm({title:"\u63D0\u793A",content:"\u786E\u5B9A\u4FDD\u5B58\u5417\uFF1F",onOk(){s.value.fragments.forEach((l,n)=>{l.orderIndex=n}),K(s.value).then(()=>{A.success("\u4FDD\u5B58\u6210\u529F")})}})},F=l=>{const{id:n,name:m,model:M}=l;n?K({id:n,name:m,model:M,fragments:s.value.fragments}).then(()=>{A.success("\u66F4\u65B0\u6210\u529F"),_.value=!1,L(t).then(C=>{c.value=C.data})}):Ae({name:m,model:M,groupId:t}).then(()=>{A.success("\u521B\u5EFA\u6210\u529F"),_.value=!1,L(t).then(C=>{c.value=C.data})})},B=()=>{v.id=null,v.name="",v.model="gpt-3.5-turbo",_.value=!0},I=()=>{const{id:l,name:n,model:m}=s.value;v.id=l,v.name=n,v.model=m,_.value=!0},d=l=>{t=l[0],L(t).then(n=>{const m=n.data;m.length?(h.value=m[0].id,P(m[0].id)):(h.value=null,s.value={}),c.value=m})},ae=()=>{X.confirm({title:"\u63D0\u793A",content:`\u786E\u5B9A\u5220\u9664${s.value.name}\u5417\uFF1F`,onOk(){Ue(s.value.id).then(()=>{A.success("\u5220\u9664\u6210\u529F"),d([t])})}})},le=()=>{ie().then(l=>{const n=pe(l.data);u.value=n,n.length>0&&(y.value=[n[0].id],d(y.value))})},oe=()=>{S.value=!0},se=()=>{window.localStorage.setItem("prompt",j.value),a.push("/chat")};return be(()=>{le()}),(l,n)=>{const m=i("a-tree"),M=i("a-select-option"),C=i("a-select"),re=i("a-textarea"),D=i("a-button"),ue=i("a-modal"),ce=i("page-container");return b(),N(ce,null,{default:p(()=>[k("div",Be,[k("div",Ie,[o(m,{selectedKeys:y.value,"onUpdate:selectedKeys":n[0]||(n[0]=r=>y.value=r),"tree-data":u.value,"field-names":{children:"children",title:"name",key:"id"},onSelect:d},null,8,["selectedKeys","tree-data"])]),k("div",De,[k("div",Ee,[o(C,{value:h.value,"onUpdate:value":n[1]||(n[1]=r=>h.value=r),class:"prompt-content-name",onChange:P},{default:p(()=>[(b(!0),w(G,null,R(c.value,r=>(b(),N(M,{key:r.id,value:r.id},{default:p(()=>[$(H(r.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),o(f(W),{class:"prompt-icon-add",onClick:B}),o(f(ge),{class:"prompt-icon-edit",onClick:I}),o(f(Me),{class:"prompt-icon-save",onClick:z}),o(f(Oe),{class:"prompt-icon-delete",onClick:ae})]),s.value.id?(b(),w("div",Le,[(b(!0),w(G,null,R(s.value.fragments,(r,E)=>(b(),w("div",{key:r.id,class:"prompt-item"},[o(f(ye),{class:Se(["prompt-checked",{active:r.selected}]),onClick:V=>J(E)},null,8,["class","onClick"]),o(re,{value:r.content,"onUpdate:value":V=>r.content=V,"auto-size":{minRows:1,maxRows:10},class:"prompt-text"},null,8,["value","onUpdate:value"]),o(f(W),{class:"prompt-plus",onClick:V=>g(E)},null,8,["onClick"]),o(f(we),{class:"prompt-minus",onClick:V=>U(E)},null,8,["onClick"])]))),128)),o(D,{class:"prompt-btn",type:"primary",onClick:n[2]||(n[2]=r=>g())},{default:p(()=>[$("\u6DFB\u52A0")]),_:1}),o(D,{class:"prompt-btn",type:"primary",onClick:n[3]||(n[3]=r=>oe())},{default:p(()=>[$("\u9884\u89C8")]),_:1}),o(D,{class:"prompt-btn",type:"primary",onClick:n[4]||(n[4]=r=>se())},{default:p(()=>[$("\u63D0\u4EA4")]),_:1})])):he("",!0)])]),o(Fe,{visible:_.value,"onUpdate:visible":n[5]||(n[5]=r=>_.value=r),"form-state":v,onSubmit:F},null,8,["visible","form-state"]),o(ue,{visible:S.value,"onUpdate:visible":n[6]||(n[6]=r=>S.value=r),title:"\u9884\u89C8",footer:null,width:800,"body-style":{height:"calc(100vh - 200px)",overflow:"auto"}},{default:p(()=>[k("div",Ne,H(j.value),1)]),_:1},8,["visible","body-style"])]),_:1})}}});var Te=ve(Ge,[["__scopeId","data-v-8d0bf6b4"]]);export{Te as default};
